Fix #2526
Fix #2620
Fixing issues #2631 and #2634
Fix #2642
Fix #2648
Fix #2659
Fix #2660
Fix #2662, #2664, #2666
Further additions wrt #2664
Minor refactoring wrt #2632
