Fix #2660
Fix #2662, #2664, #2666
Fix #2642
Fix #2659
Further additions wrt #2664
Fixing issues #2631 and #2634
Fix #2526
Fix #2648
Minor refactoring wrt #2632
Fix #2620
